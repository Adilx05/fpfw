// ------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a C4 community web.
//  
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
//     
//     INFO: For extending behaviour of each generated class create another partial 
//     class in same namespace (public partial class [ClassName] { })
// </auto-generated>
// ------------------------------------------------------------------------------
using Gamanet.C4.Driver.SimpleDriver.Helpers;
using Gamanet.C4.SDK.Enums.Logs;
using Gamanet.C4.SDK.Framework4.Device.Builder;
using Gamanet.C4.SimpleInterfaces;
using System;
using System.Collections.Generic;

namespace Gamanet.C4.Driver.SimpleDriver.Devices
{
    internal static partial class OutputExtensions
    {
        internal static void LogEvent (this IDeviceLogger devLog, 
                                       Output device,
                                       Guid eventId,
                                       DateTime evtTime = default, 
                                       Dictionary<string, object> parameters = default)
        {
            var srcTime = DateTime.UtcNow;

            if (evtTime != default)
            {
                srcTime = evtTime;
            }
            else
            {
                if (device.DriverContext.TryGetService(out TimeService timeService))
                {
                    srcTime = timeService.Now;
                }
            }

            var log = new SimpleLogV1(Guid.NewGuid(), null, Guid.Empty, eventId)
            {
                Data = new Dictionary<string, object>
                {
                    ["DeviceId"] = device.SimpleDevice.Id,
                    ["SourceTime"] = srcTime
                }
            };

            if (parameters != null)
                foreach (var par in parameters)
                    log.Data.Add(par.Key, par.Value);
            
            device.DriverContext.SimpleClient.Logs.Create(log);
        }

        internal static void CommandFailed(this IDeviceLogger devLog
                                           , Output device
                                           , System.Guid CommandId                                      
                                           , System.String Description                                      
                                           , System.Guid IssuerPersonId                                      
                                           , DateTime evtTime = default
                                           , System.String CommandIdName = default
                                           , System.String DeviceIdName = default
                                           , System.String IssuerPersonIdName = default
                                           , Dictionary<string, object> parameters = default)
        {
            var pars = new Dictionary<string, object>(parameters == default ? new Dictionary<string, object>() : parameters)
            {
                { nameof(CommandId), CommandId },
                { nameof(Description), Description },
                { nameof(IssuerPersonId), IssuerPersonId },
            };

            if(CommandIdName != default)
            {
                pars.Add(nameof(CommandIdName), CommandIdName);
            }
            if(DeviceIdName != default)
            {
                pars.Add(nameof(DeviceIdName), DeviceIdName);
            }
            if(IssuerPersonIdName != default)
            {
                pars.Add(nameof(IssuerPersonIdName), IssuerPersonIdName);
            }
 
            LogEvent(devLog, device, LogCategory.CommandFailed, evtTime, pars);
        }
        internal static void DeviceTurnedOnTimed(this IDeviceLogger devLog
                                           , Output device
                                           , System.TimeSpan Time                                      
                                           , DateTime evtTime = default
                                           , System.String DeviceIdName = default
                                           , Dictionary<string, object> parameters = default)
        {
            var pars = new Dictionary<string, object>(parameters == default ? new Dictionary<string, object>() : parameters)
            {
                { nameof(Time), Time },
            };

            if(DeviceIdName != default)
            {
                pars.Add(nameof(DeviceIdName), DeviceIdName);
            }
 
            LogEvent(devLog, device, LogCategory.DeviceTurnedOnTimed, evtTime, pars);
        }
        internal static void DuplicateAddressDetected(this IDeviceLogger devLog
                                           , Output device
                                           , System.Guid Device1Id                                      
                                           , System.Guid Device2Id                                      
                                           , System.String HardwareAddress                                      
                                           , DateTime evtTime = default
                                           , System.String Device1IdName = default
                                           , System.String Device2IdName = default
                                           , Dictionary<string, object> parameters = default)
        {
            var pars = new Dictionary<string, object>(parameters == default ? new Dictionary<string, object>() : parameters)
            {
                { nameof(Device1Id), Device1Id },
                { nameof(Device2Id), Device2Id },
                { nameof(HardwareAddress), HardwareAddress },
            };

            if(Device1IdName != default)
            {
                pars.Add(nameof(Device1IdName), Device1IdName);
            }
            if(Device2IdName != default)
            {
                pars.Add(nameof(Device2IdName), Device2IdName);
            }
 
            LogEvent(devLog, device, LogCategory.DuplicateAddressDetected, evtTime, pars);
        }
        internal static void DeviceTurnedOff(this IDeviceLogger devLog
                                           , Output device
                                           , DateTime evtTime = default
                                           , System.String DeviceIdName = default
                                           , Dictionary<string, object> parameters = default)
        {
            var pars = new Dictionary<string, object>(parameters == default ? new Dictionary<string, object>() : parameters)
            {
            };

            if(DeviceIdName != default)
            {
                pars.Add(nameof(DeviceIdName), DeviceIdName);
            }
 
            LogEvent(devLog, device, LogCategory.DeviceTurnedOff, evtTime, pars);
        }
        internal static void DeviceTurnedOn(this IDeviceLogger devLog
                                           , Output device
                                           , DateTime evtTime = default
                                           , System.String DeviceIdName = default
                                           , Dictionary<string, object> parameters = default)
        {
            var pars = new Dictionary<string, object>(parameters == default ? new Dictionary<string, object>() : parameters)
            {
            };

            if(DeviceIdName != default)
            {
                pars.Add(nameof(DeviceIdName), DeviceIdName);
            }
 
            LogEvent(devLog, device, LogCategory.DeviceTurnedOn, evtTime, pars);
        }
    }
}